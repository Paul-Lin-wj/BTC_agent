{"version":3,"file":"component---src-pages-auth-tsx-c998141db560bfa16f6b.js","mappings":";;;;;;;;;;AAAA;;AAE+B;AACG;AACa;AAG/C,MAAMG,QAAQ,GAAGA,CAAA,KAAM;EACrB,MAAM;IAAEC;EAAQ,CAAC,GAAGJ,6CAAgB,CAACE,gEAAU,CAAC;EAChDF,4CAAe,CAAC,MAAM;IACpB,MAAMO,MAAM,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;IAC1D,MAAMC,KAAK,GAAGL,MAAM,CAACM,GAAG,CAAC,OAAO,CAAC;IACjC,MAAMC,QAAQ,GAAGP,MAAM,CAACM,GAAG,CAAC,UAAU,CAAC;IACvC,IAAID,KAAK,IAAIE,QAAQ,EAAE;MACrBC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEJ,KAAK,CAAC;MACpCG,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEF,QAAQ,CAAC;MAC1CC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEF,QAAQ,CAAC,CAAC,CAAC;MAC9CC,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEF,QAAQ,CAAC;;MAE3C;MACAC,YAAY,CAACE,UAAU,CAAC,mBAAmB,CAAC;;MAE5C;MACAb,OAAO,CAAC;QACNc,IAAI,EAAEJ,QAAQ;QACdK,KAAK,EAAEL,QAAQ;QACfA,QAAQ,EAAEA;MACZ,CAAC,CAAC;MACF;MACAb,gDAAQ,CAAC,GAAG,CAAC;IACf,CAAC,MAAM;MACL;MACAA,gDAAQ,CAAC,YAAY,CAAC;IACxB;EACF,CAAC,EAAE,EAAE,CAAC;EACN,oBAAOD,gDAAA,cAAK,qDAAgB,CAAC;AAC/B,CAAC;AAED,+DAAeG,QAAQ","sources":["webpack://Dr.Sai/./src/pages/auth.tsx"],"sourcesContent":["// 接收sso登录的回调，负责保存token和username到本地存储，并跳转到主页\n\nimport * as React from \"react\";\nimport { navigate } from \"gatsby\";\nimport { appContext } from \"../hooks/provider\";\n\n\nconst AuthPage = () => {\n  const { setUser } = React.useContext(appContext);\n  React.useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const token = params.get(\"token\");\n    const username = params.get(\"username\");\n    if (token && username) {\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"username\", username);\n      localStorage.setItem(\"user_email\", username); // 假设username就是email\n      localStorage.setItem(\"user_name\", username);\n\n      // 清除之前的agent选择，确保新用户登录后使用默认agent\n      localStorage.removeItem(\"drsai-mode-config\");\n\n      // 更新用户状态\n      setUser({\n        name: username,\n        email: username,\n        username: username,\n      });\n      // 跳转到主页\n      navigate(\"/\");\n    } else {\n      // 没有参数，跳转到登录\n      navigate(\"/sso-login\");\n    }\n  }, []);\n  return <div>正在登录，请稍候...</div>;\n};\n\nexport default AuthPage;\n"],"names":["React","navigate","appContext","AuthPage","setUser","useContext","useEffect","params","URLSearchParams","window","location","search","token","get","username","localStorage","setItem","removeItem","name","email","createElement"],"sourceRoot":""}